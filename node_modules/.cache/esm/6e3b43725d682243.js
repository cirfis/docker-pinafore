let svgs,path,fs,promisify,SVGO,$;_5d6‍.x([["buildSvg",()=>buildSvg]]);_5d6‍.w("./svgs",[["default",["svgs"],function(v){svgs=v}]]);_5d6‍.w("path",[["default",["path"],function(v){path=v}]]);_5d6‍.w("fs",[["default",["fs"],function(v){fs=v}]]);_5d6‍.w("util",[["promisify",["promisify"],function(v){promisify=v}]]);_5d6‍.w("svgo",[["default",["SVGO"],function(v){SVGO=v}]]);_5d6‍.w("cheerio",[["default",["$"],function(v){$=v}]]);






const svgo = new SVGO()
const readFile = promisify(fs.readFile)
const writeFile = promisify(fs.writeFile)

async function readSvg (svg) {
  const filepath = path.join(__dirname, '../', svg.src)
  const content = await readFile(filepath, 'utf8')
  const optimized = (await svgo.optimize(content))
  const $optimized = $(optimized.data)
  const $path = $optimized.find('path, circle').removeAttr('fill')
  const viewBox = $optimized.attr('viewBox') || `0 0 ${$optimized.attr('width')} ${$optimized.attr('height')}`
  const $symbol = $('<symbol></symbol>')
    .attr('id', svg.id)
    .attr('viewBox', viewBox)
    .append($path)
  return $.xml($symbol)
}

       async function buildSvg () {
  const inlineSvgs = svgs.filter(_ => _.inline)
  const regularSvgs = svgs.filter(_ => !_.inline)

  const inlineSvgStrings = (await Promise.all(inlineSvgs.map(readSvg))).join('')
  const regularSvgStrings = (await Promise.all(regularSvgs.map(readSvg))).join('')

  const inlineOutput = `<svg xmlns="http://www.w3.org/2000/svg" style="display:none">${inlineSvgStrings}</svg>`
  const regularOutput = `<svg xmlns="http://www.w3.org/2000/svg">${regularSvgStrings}</svg>`

  await writeFile(path.resolve(__dirname, '../static/icons.svg'), regularOutput, 'utf8')

  return inlineOutput
}
